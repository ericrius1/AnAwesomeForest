<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Forest</title>
        <meta name="description" content="">
        <!-- This assumes your project will be responsive -->
        <meta name="viewport" content="width=device-width">
        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
        <link rel="stylesheet" href="css/main.css">


        <script src="js/vendor/three.min.js"></script>
        <script src="js/vendor/Mirror.js"></script>
        <script src="js/vendor/WaterShader.js"></script>
        <script src="js/vendor/ShaderParticles.js"></script>
        <script src="assets/josefin_slab_regular.typeface.js"></script>
        <script src="js/vendor/underscore.js"></script>
        <script src="js/vendor/tween.min.js"></script>
        <script src="js/vendor/CurveExtras.js"></script>
        <script src="js/vendor/PointerLockControls.js"></script>
        <script src="js/vendor/OrbitControls.js"></script>
        <script src="js/vendor/Class.js"></script>

        <script src = "js/postprocessing/CopyShader.js"></script>
        <script src = "js/postprocessing/ConvolutionShader.js"></script>
        <script src = "js/postprocessing/EffectComposer.js"></script>
        <script src = "js/postprocessing/ShaderPass.js"></script>
        <script src = "js/postprocessing/BokehShader.js"></script>
        <script src = "js/postprocessing/BokehPass.js"></script>
        <script src = "js/postprocessing/FXAAShader.js"></script>
        <script src = "js/postprocessing/MaskPass.js"></script>
        <script src = "js/postprocessing/RenderPass.js"></script>
        <script src = "js/postprocessing/BloomPass.js"></script>
       
        <script src="js/e.js"></script>
        <script src="js/classes/e.EventEmitter.js"></script>
        <script src="js/classes/e.Keyboard.js"></script>
        <script src="js/classes/e.Player.js"></script>
        <script src="js/classes/e.World.js"></script>
        <script src="js/classes/e.Ocean.js"></script>
        <script src="js/classes/e.Fountains.js"></script>
        <script src="js/classes/e.Statue.js"></script>
        <script src="js/classes/e.Landscape.js"></script>
        <script src="js/classes/e.Statue.js"></script>
        <script src="js/classes/e.DistantLands.js"></script>
        <script src="js/classes/e.Bird.js"></script>
        <script src="js/classes/e.SkyWriting.js"></script>
        <script src="js/classes/e.Snow.js"></script>
        <script src="js/classes/e.Forest.js"></script>
        <script src="js/classes/e.Controls.js"></script>
        <script src="js/classes/e.Game.js"></script>

        <!-- // <script src = "build/game.js"></script> -->

      <script id="vertexShader" type="x-shader/x-vertex">
        varying float y;
        uniform float height;

        void main() {
          y = position.y / height;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }

      </script>

      <script id="fragmentShader" type="x-shader/x-fragment">
        varying float y;
        void main() {
          float y2 = pow(y, 2.5);
          float r = mix(0.23, 0.67, y2 );
          float g = mix(0.09, 0.188, y2);
          gl_FragColor = vec4(r, g, 0.047, 1.0);

        }

      </script>

      <script id="leafVertexShader" type="x-shader/x-vertex">

        precision mediump float;
        precision mediump int;

        uniform float width;
        uniform float time;

        attribute float pivotPoint;
        attribute float wind;
        attribute vec3 color;

        uniform vec3 velocity;
        uniform float fallTime;


        varying vec3 vColor;

        void main() {
          vColor = color;
          vec3 newPos = position;
          float clampedWind = max(0.8, wind);
          if(pivotPoint > 0.5){
            newPos.z = position.z + sin(time * (5. * wind)) * (2. * wind);
          }
          if(length(velocity) > 0.0){
            vec3 adjustedVelocity = velocity * clampedWind;
              adjustedVelocity.x = mix(-50.0, 50.0, wind);
              adjustedVelocity.y += adjustedVelocity.y * wind;
            
            newPos = newPos + adjustedVelocity * fallTime;
          }

          gl_Position = projectionMatrix * modelViewMatrix * vec4( newPos, 1.0 );

        }

    </script>

    <script id="leafFragmentShader" type="x-shader/x-fragment">

      precision mediump float;
      precision mediump int;

      uniform float changePoint;

      uniform float alpha;
      uniform vec3 originalColor;
      uniform float fallTime;
      uniform vec3 velocity;

      varying float x;
      varying vec3 vColor;

      void main() {
        float adjustedAlpa = alpha;
        if(length(velocity) > 0.0){
          adjustedAlpa = max(0.0, alpha - fallTime/30.0);
        }
        vec3 curColor = mix(originalColor, vColor, changePoint);
        vec4 color = vec4(curColor, adjustedAlpa );
        gl_FragColor = color;

      }

    </script>

       

        <script>
          window.onload = function(){
            e.init();
          }
        </script>
    </head>
    <body>
      <div id = "pointer"></div>

  

    </body>
</html>
